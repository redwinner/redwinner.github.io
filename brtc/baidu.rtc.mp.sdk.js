//https://cloud.baidu.com/doc/RTC/index.html#MiniAppSDKV0.0.1
if(typeof window!='object'){window=global;}
!function(e){var n={};function o(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=n,o.d=function(e,n,t){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)o.d(t,i,function(n){return e[n]}.bind(null,i));return t},o.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="",o(o.s=0)}([function(e,n,o){"use strict";const t="BRTC.RTMP.MiniApp.SDK V0.0.1";function i(e){if(void 0===i.initDone)return e.error("Library not initialized"),{};if(i.log("Library initialized: "+i.initDone),(e=e||{}).success="function"==typeof e.success?e.success:i.noop,e.error="function"==typeof e.error?e.error:i.noop,e.destroyed="function"==typeof e.destroyed?e.destroyed:i.noop,e.onmessage="function"==typeof e.onmessage?e.onmessage:i.noop,e.onuserevent="function"==typeof e.onuserevent?e.onuserevent:i.noop,e.onsessionevent="function"==typeof e.onsessionevent?e.onsessionevent:i.noop,null===e.server||void 0===e.server)return e.error("Invalid server url"),{};var n=!1,o=null,t={},r=null,s=null,u="object"==typeof wx&&"function"==typeof wx.connectSocket,l=null,a=0,c=e.server;i.isArray(c)?(i.log("Multiple servers provided ("+c.length+"), will use the first that works"),c=null,l=e.server,i.debug(l)):0===c.indexOf("ws")?(n=!0,i.log("Using WebSockets to contact Janus: "+c)):(n=!1,i.log("Using REST API to contact Janus: "+c));e.iceTransportPolicy,e.bundlePolicy;var d=e.ipv6;null==d&&(d=!1);void 0!==e.withCredentials&&null!==e.withCredentials&&e.withCredentials;var f=10;void 0!==e.max_poll_events&&null!==e.max_poll_events&&(f=e.max_poll_events),f<1&&(f=1);var v=null;void 0!==e.token&&null!==e.token&&(v=e.token);var p=null;void 0!==e.apisecret&&null!==e.apisecret&&(p=e.apisecret),this.destroyOnUnload=!0,void 0!==e.destroyOnUnload&&null!==e.destroyOnUnload&&(this.destroyOnUnload=!0===e.destroyOnUnload);var g=25e3;void 0!==e.keepAlivePeriod&&null!==e.keepAlivePeriod&&(g=e.keepAlivePeriod),isNaN(g)&&(g=25e3);var m=!1,b=null,h={},w=this,_={};e.userid;function T(e,t){if(0,"keepalive"!==e.janus)if("ack"!==e.janus)if("success"!==e.janus)if("trickle"===e.janus);else{if("webrtcup"===e.janus)return i.debug("Got a webrtcup event on session "+b),i.debug(e),null==(u=e.sender)?void i.warn("Missing sender..."):null==(c=h[u])?void i.debug("This handle is not attached to this session"):void c.webrtcState(!0);if("hangup"===e.janus){if(i.debug("Got a hangup event on session "+b),i.debug(e),null==(u=e.sender))return void i.warn("Missing sender...");if(null==(c=h[u]))return void i.debug("This handle is not attached to this session");c.webrtcState(!1,e.reason),c.hangup()}else if("detached"===e.janus){if(i.debug("Got a detached event on session "+b),i.debug(e),null==(u=e.sender))return void i.warn("Missing sender...");if(null==(c=h[u]))return;c.detached=!0,c.ondetached(),c.detach()}else if("media"===e.janus){if(i.debug("Got a media event on session "+b),i.debug(e),null==(u=e.sender))return void i.warn("Missing sender...");if(null==(c=h[u]))return void i.debug("This handle is not attached to this session");c.mediaState(e.type,e.receiving)}else if("slowlink"===e.janus){if(i.debug("Got a slowlink event on session "+b),i.debug(e),null==(u=e.sender))return void i.warn("Missing sender...");if(null==(c=h[u]))return void i.debug("This handle is not attached to this session");c.slowLink(e.uplink,e.nacks)}else{if("error"===e.janus){var r,s;if(i.error("Ooops: "+e.error.code+" "+e.error.reason),i.debug(e),null!=(r=e.transaction))null!=(s=_[r])&&s(e),delete _[r];return}if("event"===e.janus){var u;if(i.debug("Got a plugin event on session "+b),i.debug(e),null==(u=e.sender)){var l=e.recvdata;if(null!=l)return void i.sessions[b].onmessage(l);var a=e.detached;return null!=a?void i.sessions[b].onuserevent(e):void i.warn("Missing sender...")}if(null==(p=e.plugindata))return void i.warn("Missing plugindata...");i.debug("  -- Event is coming from "+u+" ("+p.plugin+")");var c,d=p.data;if(i.debug(d),null==(c=h[u]))return void i.warn("This handle is not attached to this session");var f=e.jsep;null!=f&&(i.debug("Handling SDP as well..."),i.debug(f));var v=c.onmessage;null!=v?(i.debug("Notifying application..."),v(d,f)):i.debug("No provided notification callback")}else{if("timeout"===e.janus)return i.error("Timeout on session "+b),i.debug(e),void(n&&o.close(3504,"Gateway timeout"));var p;if("userevent"===e.janus)return null==(p=e.plugindata)?void i.warn("Missing plugindata..."):null==(d=p.data)?void i.warn('Missing plugindata["data"]...'):e.plugindata?void i.sessions[b].onuserevent(d):void 0;if("sessionevent"===e.janus)return void i.sessions[b].onsessionevent(e);i.warn('Unknown message/event  "'+e.janus+'" on session '+b),i.debug(e)}}}else i.debug("Got a success on session "+b),i.debug(e),null!=(r=e.transaction)&&(null!=(s=_[r])&&s(e),delete _[r]);else i.debug("Got an ack on session "+b),i.debug(e),null!=(r=e.transaction)&&(null!=(s=_[r])&&s(e),delete _[r]);else i.vdebug("Got a keepalive on session "+b)}function R(e){u?s.send({data:JSON.stringify(e)}):o.send(JSON.stringify(e))}function y(){if(null!==c&&n&&m){r=setTimeout(y,g);var e={janus:"keepalive",session_id:b,transaction:i.randomString(12),ts:(new Date).toLocaleString()};null!=v&&(e.token=v),null!=p&&(e.apisecret=p),R(e)}}function C(d){var f=i.randomString(12),h={janus:"create",transaction:f};if(void 0!==d.mediaserverip&&null!==d.mediaserverip&&(h.janusIp=d.mediaserverip),void 0!==d.userevent&&!1!==d.userevent&&(h.userevent=d.userevent),void 0!==d.sessionevent&&!1!==d.sessionevent&&(h.sessionevent=d.sessionevent),void 0!==d.sdktag&&null!==d.sdktag&&(h.sdktag=d.sdktag),d.reconnect&&(m=!1,h.janus="claim",h.session_id=b,o&&(o.onopen=null,o.onerror=null,o.onclose=null,r&&(clearTimeout(r),r=null))),null!=v&&(h.token=v),null!=p&&(h.apisecret=p),null===c&&i.isArray(l)&&(0===(c=l[a]).indexOf("ws")?(n=!0,i.log("Server #"+(a+1)+": trying WebSockets to contact Janus ("+c+")")):(n=!1,i.log("Server #"+(a+1)+": trying REST API to contact Janus ("+c+")"))),u)return(s=wx.connectSocket({url:c,protocols:["janus-protocol"]})).onOpen(()=>{_[f]=function(e){"success"===e.janus&&(r=setTimeout(y,g),m=!0,b=e.session_id?e.session_id:e.data.id,i.sessions[b]=w,e.data.version&&e.data.version,d.success())},R(h)}),s.onMessage(e=>{T(JSON.parse(e.data))}),void s.onClose(()=>{m=!1});if(n)for(var C in o=new WebSocket(c,"janus-protocol"),t={error:function(){i.error("Error connecting to the Janus WebSockets server... "+c),d.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){_[f]=function(e){if(i.debug(e),"success"!==e.janus)return i.error("Ooops: "+e.error.code+" "+e.error.reason),void d.error(e.error.reason);r=setTimeout(y,g),m=!0,b=e.session_id?e.session_id:e.data.id,d.reconnect?i.log("Claimed session: "+b):i.log("Created session: "+b),i.sessions[b]=w,e.data.version&&e.data.version,d.success()},R(h)},message:function(e){T(JSON.parse(e.data))},close:function(){null!==c&&m&&(m=!1,e.error("Lost connection to the server (is it down?)"))}})o.addEventListener(C,t[C]);else;}function S(e,o){(o=o||{}).success="function"==typeof o.success?o.success:i.noop,o.error="function"==typeof o.error?o.error:i.noop;var t=!0;void 0!==o.asyncRequest&&null!==o.asyncRequest&&(t=!0===o.asyncRequest);var r=!1;void 0!==o.noRequest&&null!==o.noRequest&&(r=!0===o.noRequest),i.log("Destroying handle "+e+" (async="+t+")"),B(e);var s=h[e];if(null==s||s.detached)return delete h[e],void o.success();if(r)return delete h[e],void o.success();if(!m)return i.warn("Is the server down? (connected=false)"),void o.error("Is the server down? (connected=false)");var u={janus:"detach",transaction:i.randomString(12)};return null!==s.token&&void 0!==s.token&&(u.token=s.token),null!=p&&(u.apisecret=p),n?(u.session_id=b,u.handle_id=e,R(u),delete h[e],void o.success()):void 0}function B(e,o){i.log("Cleaning WebRTC stuff");var t=h[e];if(null!=t){var r=t.webrtcStuff;if(null!=r){if(!0===o){var s={janus:"hangup",transaction:i.randomString(12)};null!==t.token&&void 0!==t.token&&(s.token=t.token),null!=p&&(s.apisecret=p),i.debug("Sending hangup request (handle="+e+"):"),i.debug(s),n&&(s.session_id=b,s.handle_id=e,R(s))}r.remoteStream=null,r.volume={},r.fps.fsnow=null,r.fps.fsbefore=null,r.fps.tsnow=null,r.fps.tsbefore=null,r.fps.value=null,r.streamExternal=!1,r.myStream=null,r.pc=null,r.candidates=null,r.mySdp=null,r.remoteSdp=null,r.iceDone=!1,r.dataChannel={},r.dtmfSender=null}t.oncleanup()}}C(e),this.getServer=function(){return c},this.isConnected=function(){return m},this.reconnect=function(e){(e=e||{}).success="function"==typeof e.success?e.success:i.noop,e.error="function"==typeof e.error?e.error:i.noop,e.reconnect=!0,C(e)},this.getSessionId=function(){return b},this.destroy=function(l){!function(l){(l=l||{}).success="function"==typeof l.success?l.success:i.noop;var a=!0;void 0!==l.asyncRequest&&null!==l.asyncRequest&&(a=!0===l.asyncRequest);var c=!0;void 0!==l.notifyDestroyed&&null!==l.notifyDestroyed&&(c=!0===l.notifyDestroyed);var d=!1;void 0!==l.cleanupHandles&&null!==l.cleanupHandles&&(d=!0===l.cleanupHandles);if(i.log("Destroying session "+b+" (async="+a+")"),!m)return i.warn("Is the server down? (connected=false)"),void l.success();if(null==b)return i.warn("No session to destroy"),l.success(),void(c&&e.destroyed());if(d)for(var f in h)S(f,{noRequest:!0});var g={janus:"destroy",transaction:i.randomString(12)};null!=v&&(g.token=v);null!=p&&(g.apisecret=p);if(n){if(g.session_id=b,u)return R(g),void setTimeout(()=>{s.close()},0);var w=function(){for(var e in t)o.removeEventListener(e,t[e]);o.removeEventListener("message",_),o.removeEventListener("error",T),r&&clearTimeout(r),o.close()},_=function(n){var o=JSON.parse(n.data);o.session_id===g.session_id&&o.transaction===g.transaction&&(w(),l.success(),c&&e.destroyed())},T=function(n){w(),l.error("Failed to destroy the server: Is the server down?"),c&&e.destroyed()};o.addEventListener("message",_),o.addEventListener("error",T),1===o.readyState&&R(g)}}(l)},this.attach=function(e){!function(e){if((e=e||{}).success="function"==typeof e.success?e.success:i.noop,e.error="function"==typeof e.error?e.error:i.noop,e.consentDialog="function"==typeof e.consentDialog?e.consentDialog:i.noop,e.iceState="function"==typeof e.iceState?e.iceState:i.noop,e.mediaState="function"==typeof e.mediaState?e.mediaState:i.noop,e.webrtcState="function"==typeof e.webrtcState?e.webrtcState:i.noop,e.slowLink="function"==typeof e.slowLink?e.slowLink:i.noop,e.onmessage="function"==typeof e.onmessage?e.onmessage:i.noop,e.onlocalstream="function"==typeof e.onlocalstream?e.onlocalstream:i.noop,e.onremotestream="function"==typeof e.onremotestream?e.onremotestream:i.noop,e.ondata="function"==typeof e.ondata?e.ondata:i.noop,e.ondataopen="function"==typeof e.ondataopen?e.ondataopen:i.noop,e.oncleanup="function"==typeof e.oncleanup?e.oncleanup:i.noop,e.ondetached="function"==typeof e.ondetached?e.ondetached:i.noop,!m)return i.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var o=e.plugin;if(null==o)return i.error("Invalid plugin"),void e.error("Invalid plugin");var t=e.opaqueId,r=e.token?e.token:v,s=i.randomString(12),u={janus:"attach",plugin:o,opaque_id:t,transaction:s};null!=r&&(u.token=r);null!=p&&(u.apisecret=p);if(n)_[s]=function(t){if(i.debug(t),"success"!==t.janus)return i.error("Ooops: "+t.error.code+" "+t.error.reason),void e.error("Ooops: "+t.error.code+" "+t.error.reason);var s=t.data.id;i.log("Created handle: "+s);var u={session:w,plugin:o,id:s,token:r,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null},fps:{value:null,fsnow:null,fsbefore:null,tsnow:null,tsbefore:null,timer:null},stats:null},getId:function(){return s},getPlugin:function(){return o},getVolume:function(){return 2},getRemoteVolume:function(){return 2},getLocalVolume:function(){return 2},isAudioMuted:function(){return!1},muteAudio:function(){},unmuteAudio:function(){},isVideoMuted:function(){return!1},muteVideo:function(){},unmuteVideo:function(){},send:function(e){!function(e,o){if((o=o||{}).success="function"==typeof o.success?o.success:i.noop,o.error="function"==typeof o.error?o.error:i.noop,!m)return i.warn("Is the server down? (connected=false)"),void o.error("Is the server down? (connected=false)");var t=h[e];if(null==t||null===t.webrtcStuff||void 0===t.webrtcStuff)return i.warn("Invalid handle"),void o.error("Invalid handle");var r=o.message,s=o.jsep,u=i.randomString(12),l={janus:"message",body:r,transaction:u};null!==t.token&&void 0!==t.token&&(l.token=t.token);null!=p&&(l.apisecret=p);null!=s&&(l.jsep=s);if(i.debug("Sending message to plugin (handle="+e+"):"),i.debug(l),n)l.session_id=b,l.handle_id=e,_[u]=function(e){if(i.debug("Message sent!"),i.debug(e),"success"===e.janus){var n=e.plugindata;if(null==n)return i.warn("Request succeeded, but missing plugindata..."),void o.success();i.log("Synchronous transaction successful ("+n.plugin+")");var t=n.data;return i.debug(t),void o.success(t)}"ack"===e.janus?o.success():void 0!==e.error&&null!==e.error?(i.error("Ooops: "+e.error.code+" "+e.error.reason),o.error(e.error.code+" "+e.error.reason)):(i.error("Unknown error"),o.error("Unknown error"))},R(l)}(s,e)},data:function(e){!function(e,n){(n=n||{}).success="function"==typeof n.success?n.success:i.noop,n.error="function"==typeof n.error?n.error:i.noop,n.success()}(0,e)},dtmf:function(e){},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){},createAnswer:function(e){},handleRemoteJsep:function(e){},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){B(s,!0===e)},detach:function(e){S(s,e)}};h[s]=u,e.success(u)},u.session_id=b,R(u)}(e)},this.send=function(e){!function(e){if((e=e||{}).success="function"==typeof e.success?e.success:i.noop,e.error="function"==typeof e.error?e.error:i.noop,!m)return;var o=e.message,t=i.randomString(12),r={janus:"message",body:o,transaction:t};if(n)r.session_id=b,_[t]=function(n){if("success"===n.janus){var o=n.data;return null==o?(i.warn("Request succeeded, but missing data..."),void e.success()):void e.success(o)}e.success()},R(r)}(e)},this.sendlog=function(e){!function(e){if((e=e||{}).success="function"==typeof e.success?e.success:i.noop,e.error="function"==typeof e.error?e.error:i.noop,!m)return;var o=e.log,t=i.randomString(12),r={janus:"sdklog",log:o,transaction:t};if(n)r.session_id=b,_[t]=function(n){"success"!==n.janus?e.success():e.success("janus success")},R(r)}(e)},this.onmessage=function(n){e.onmessage(n)},this.onuserevent=function(n){e.onuserevent(n)},this.onsessionevent=function(n){e.onsessionevent(n)}}function r(e,n,o){null==o&&(o={}),o.success="function"==typeof o.success?o.success:function(){},o.error="function"==typeof o.error?o.error:function(){};!function(e,n,o,t,i){if("object"==typeof wx&&"function"==typeof wx.request)return void wx.request({url:e+"?message="+l("[RTC_QUALITY_CONTROL]"+s(JSON.stringify(n))),data:"",success:function(e){},fail:function(e){}});let r=null;try{r=new XMLHttpRequest}catch(e){try{r=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){return void window.alert("Your browser does not support XMLHTTP!")}}r.open("GET",e+"?message="+btoa("[RTC_QUALITY_CONTROL]"+s(JSON.stringify(n))),!0);for(let e in o)if(o.hasOwnProperty(e)){let n=o[e];r.setRequestHeader(e,n)}r.send(),r.onreadystatechange=function(){}}(e,n,{"Content-Type":"application/json"},o.success,o.error)}function s(e){var n,o,t="";for(e=e.replace(/\r\n/g,"\n"),o=0;o<e.length;o++)(n=e.charCodeAt(o))<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128));return t}i.sessions={},i.noop=function(){},i.isArray=function(e){return Array.isArray(e)},i.init=function(e){if((e=e||{}).callback="function"==typeof e.callback?e.callback:i.noop,!0===i.initDone)e.callback();else{if("undefined"!=typeof console&&void 0!==console.log||(console={log:function(){}}),i.trace=i.noop,i.debug=i.noop,i.vdebug=i.noop,i.log=i.noop,i.warn=i.noop,i.error=i.noop,!0===e.debug||"all"===e.debug)i.trace=console.trace.bind(console),i.debug=console.debug.bind(console),i.vdebug=console.debug.bind(console),i.log=console.log.bind(console),i.warn=console.warn.bind(console),i.error=console.error.bind(console);else if(Array.isArray(e.debug))for(var n in e.debug){var o=e.debug[n];switch(o){case"trace":i.trace=console.trace.bind(console);break;case"debug":i.debug=console.debug.bind(console);break;case"vdebug":i.vdebug=console.debug.bind(console);break;case"log":i.log=console.log.bind(console);break;case"warn":i.warn=console.warn.bind(console);break;case"error":i.error=console.error.bind(console);break;default:console.error('Unknown debugging option "'+o+'" (supported: "trace", "debug", "vdebug", "log", "warn", "error")')}}i.log("Initializing library"),i.initDone=!0,e.callback()}},i.randomString=function(e){for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o="",t=0;t<e;t++){var i=Math.floor(Math.random()*n.length);o+=n.substring(i,i+1)}return o};var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function l(e){for(var n,o=String(e),t=0,i=u,r="";o.charAt(0|t)||(i="=",t%1);r+=i.charAt(63&n>>8-t%1*8))n=n<<8|o.charCodeAt(t+=.75);return r}function a(){var e=i.randomString(12);this.setThisDomID=function(e){e};var n=null;var o=null,s=null,u="brtc-client-"+e,l=!1,a=null,c=[],d=[],f=null,v=null,p=null,g=null,m=null,b=10,h="h264",w=!0,_=!1;let T=null,R=1500;var y=1e4,C="",S=!0,B=null,D=!1,k=null,j=!0,I=!0,A=!1,M=function(){},O=function(){},G=function(){},U=function(){},L=function(){},P=function(){},q=function(){},x=function(){},V=function(e){},E=function(e){},N=function(e){},J=function(e,n){},H=function(e,n){},W=[],K=[],X=function(e){},z=function(e){},F=!1,Y=function(){},Q={usingvideo:!0,usingaudio:!0,mirrorlocalvideo:!0,remoteaudioid:"",videoprofile:"hires",videoDeviceId:null,audioDeviceId:null,audioOutputDeviceId:null,myStream:null,onlocalstream:function(){}};let Z={serverUrl:"https://rtc-log.cdn.bcebos.com/collect",defaultOpen:!0,gatherInterval:2,uploadInterval:10};var $=!1,ee="online";var ne=function(){},oe=function(){},te=function(){},ie=!0,re=null;this.BRTC_Start=function(e){console.log("BRTC_Start: "+t),(e=e||{}).success="function"==typeof e.success?e.success:function(){},e.error="function"==typeof e.error?e.error:function(){},e.destroyed="function"==typeof e.destroyed?e.destroyed:function(){},e.onlocalstream="function"==typeof e.onlocalstream?e.onlocalstream:function(){},e.onlocalstream_end="function"==typeof e.onlocalstream_end?e.onlocalstream_end:function(){},e.onmessage="function"==typeof e.onmessage?e.onmessage:function(){},e.onattribute="function"==typeof e.onattribute?e.onattribute:function(){},n=null!==e.server&&void 0!==e.server?e.server:"wss://rtc2.exp.bcelive.com/janus",null!==e.videocodec&&void 0!==e.videocodec&&(h=e.videocodec),ae(e),null!==e.logintimeout&&void 0!==e.logintimeout&&(y=e.logintimeout),null!==e.logintimeoutevent&&void 0!==e.logintimeoutevent&&(x=e.logintimeoutevent),null!==e.remotevideoloading&&void 0!==e.remotevideoloading&&e.remotevideoloading,null!==e.linkdownupthreshold&&void 0!==e.linkdownupthreshold&&e.linkdownupthreshold,null!==e.linkdownevent&&void 0!==e.linkdownevent&&(ne=e.linkdownevent),null!==e.mediastate&&void 0!==e.mediastate&&(te=e.mediastate),null!==e.linkupevent&&void 0!==e.linkupevent&&(oe=e.linkupevent),setTimeout(function(){null===s&&x()},y),null!==e.userevent&&void 0!==e.userevent&&(j=e.userevent),null!==e.sessionevent&&void 0!==e.sessionevent&&(I=e.sessionevent),"function"==typeof e.userevent_joinedroom&&(J=e.userevent_joinedroom),"function"==typeof e.userevent_leavingroom&&(H=e.userevent_leavingroom),n=n+"?appid="+e.appid+"&roomname="+encodeURIComponent(e.roomname)+"&uid="+e.userid+"&token="+e.token,l||(l=!0,M=e.success,O=e.error,G=e.destroyed,U=e.onlocalstream,e.onlocalstream_end,z=e.onattribute,X=e.onmessage,null!==e.remotevideoon&&void 0!==e.remotevideoon&&e.remotevideoon,null!==e.remotevideooff&&void 0!==e.remotevideooff&&e.remotevideooff,null!==e.remotevideocoming&&void 0!==e.remotevideocoming&&(V=e.remotevideocoming),null!==e.remotevideoleaving&&void 0!==e.remotevideoleaving&&(E=e.remotevideoleaving),null!==e.remotevideounpublished&&void 0!==e.remotevideounpublished&&(N=e.remotevideounpublished),null!==e.localvideopublishing&&void 0!==e.localvideopublishing&&(L=e.localvideopublishing),null!==e.localvideopublished_ok&&void 0!==e.localvideopublished_ok&&(P=e.localvideopublished_ok),null!==e.localvideopublished_closed&&void 0!==e.localvideopublished_closed&&(q=e.localvideopublished_closed),null!==e.remotevideo_closed&&void 0!==e.remotevideo_closed&&e.remotevideo_closed,v=e.roomname,g=e.userid,f=e.appid,m=e.displayname,p=w?"publisher":"listener",i.init({debug:A,callback:function(){o=new i({server:n,userid:g,mediaserverip:k,userevent:j,sessionevent:I,sdktag:t,success:function(){o.attach({plugin:"janus.plugin.videoroom",opaqueId:u,success:function(e){var n,o;s=e,i.log("Plugin attached! ("+s.getPlugin()+", id="+s.getId()+")"),i.log("  -- This is a publisher/manager"),n=m,o={request:"create",id:parseInt(g,10),room_name:v,publishers:500,videocodec:h,app_id:f},s.send({message:o,success:function(e){i.log("create resp data:"+e),b=e.room,i.log("create roomid:"+b);var o={request:"join",room:parseInt(b,10),room_name:v,ptype:p,id:parseInt(g,10),app_id:f,role:p,token:"no_token",display:n};C.includes("rtmp")&&(o.rtmp={},o.rtmp.url={},o.rtmp.url=C,o.rtmp.mix=S,"string"==typeof B&&""!==B&&(o.rtmp.mixTemplate=B)),D&&(o.recording={},o.recording.rec=D),i.log("userid:"+g+",appid:"+f),s.send({message:o}),setTimeout(function(){pe({roomEvent:{userName:m+"("+g+")",eventDescription:"ENTER_ROOM"}}),pe({deviceInfo:{sdkVersion:t,networkType:"unknown",device:navigator?navigator.userAgent:"wechat"}})},500)}})},error:function(e){i.error("  -- Error attaching plugin...",e),O("Error attaching plugin... "+e)},consentDialog:function(e){i.debug("Consent dialog should be "+(e?"on":"off")+" now")},slowLink:function(e,n){!function(e,n){e?oe():ne()}(e)},mediaState:function(e,n){i.log("Janus "+(n?"started":"stopped")+" receiving our "+e),_&&"video"===e&&!n||(clearInterval(re),ie=n,n?te(e,n):re=setTimeout(function(){re=null,!1===ie&&te(e,!1)},5e3))},webrtcState:function(e){i.log("Janus says our WebRTC PeerConnection is "+(e?"up":"down")+" now"),P()},iceState:function(e){i.log("iceConnectionState: "+e),"disconnected"===e&&null!=o&&o.sendlog({log:{event:"publisher on iceState: disconnected",code:4,id:parseInt(g,10),ts:(new Date).toLocaleString()}})},onmessage:function(e,n){i.debug(" ::: Got a message (publisher) :::"),i.debug(JSON.stringify(e));var o=e.videoroom;if(i.debug("Event: "+o),null!=o)if("joined"===o){a=e.id,e.private_id,i.log("Successfully joined room "+e.room+" with ID "+a);var t=e.rtmp_push_url;void 0===t&&(t=""),M(t),void 0!==e.publishers&&null!==e.publishers&&ce(e)}else if("destroyed"===o)i.warn("The room has been destroyed!"),O("The room has been destroyed");else if("event"===o)if(void 0!==e.publishers&&null!==e.publishers)ce(e);else if(void 0!==e.leaving&&null!==e.leaving){var r=e.leaving;i.log("Publisher left: "+r);var u=null;c.some(e=>!(!e||"object"!=typeof e||e.rfid!==r||(u=e,0))),null!=u&&(i.debug("Feed "+u.rfid+" ("+u.rfdisplay+") has left the room, detaching"),c[u.rfindex]=null,u.detach(),E(u.rfid))}else if(void 0!==e.unpublished&&null!==e.unpublished){var l=e.unpublished;if(i.log("Publisher left: "+l),"ok"===l)return s.hangup(),void(F&&F&&(F=!1,Y()));if("self"===l)return clearInterval(re),s.hangup(),void setTimeout(function(){q()},500);var u=null;c.some(e=>!(!e||"object"!=typeof e||e.rfid!==l||(u=e,0))),null!=u&&(i.debug("Feed "+u.rfid+" ("+u.rfdisplay+") has left the room, detaching"),c[u.rfindex]=null,u.detach(),N(u.rfid))}else if(void 0!==e.error&&null!==e.error){if(435===e.error_code)return;O(e.error)}},onlocalstream:function(e,n){U(e,_?"screen":"camera"),i.debug(" ::: Got a local stream :::"),w&&(e,i.debug(JSON.stringify(e)),n&&L())},onremotestream:function(e){},oncleanup:function(){i.log(" ::: Got a cleanup notification: we are unpublished now :::"),null}})},error:function(e){i.error(e),O(e)},destroyed:function(){G("destroyed")},onuserevent:function(e,n){if(n||!I)if(e.users){var t=e.users;for(var r in i.debug("Got a list of available users:"),i.debug(t),t){var s=t[r].id,u=t[r].display,l=t[r].attribute;void 0===l&&(l=""),i.debug("  >> ["+s+"] "+u+" attr: "+l),J(s,u,l);let e={id:s,display:u,attribute:l};ue(e)}}else if(e.leaving)H(e.leaving,e.display),function(e){W.some((n,o)=>!(!n||"object"!=typeof n||n.id!==e||(W.splice(o,1),0)))}(e.leaving);else if(e.joined){J(e.joined,e.display,"");let n={id:e.joined,display:e.display,attribute:""};ue(n)}else if(e.detached){var a=e.detached;if(a.servertrigger){var f=!0;c.some((e,n)=>!(!e||"object"!=typeof e||e.rfindex!==a.feed&&e.rfid!==a.feed||(f=!1,0))),f||setTimeout(()=>{W.some((e,n)=>!(!e||"object"!=typeof e||e.id!==a.feed||(null!=o&&o.sendlog({log:{event:"on feed detached via servertrigger",code:5,feedid:a.feed,id:parseInt(g,10),ts:(new Date).toLocaleString()}}),ve(a.feed),0)))},500)}"number"==typeof a.feed&&d.some((e,n)=>!(!e||"object"!=typeof e||e.feedid!==a.feed||(e.resolve("success: feedid: "+a.feed),d.splice(n,1),0)))}},onmessage:function(e,n){if((n||!I)&&e)if(!0===e.internal){var o={id:e.from,attribute:e.data};z(o),le(o)}else{var t={id:e.from,data:e.data};X(t)}},onsessionevent:function(e){e&&I&&(e.recvdata?this.onmessage(e.recvdata,!0):e.userevent?this.onuserevent(e.userevent,!0):e.detached&&this.onuserevent(e,!0))}})}}))},this.BRTC_Stop=function(){pe({roomEvent:{userName:m+"("+g+")",eventDescription:"LEAVE_ROOM"}}),O=function(){},K=[],null!=o&&(o.destroy({cleanupHandles:!0}),o=null),s=null,c=[],d=[],W=[],[],l=!1,x=function(){}},this.BRTC_SendData=function(e,n){},this.BRTC_StopVideo=function(){};let se={};function ue(e){var n=!1;W.some((o,t)=>!(!o||"object"!=typeof o||o.id!==e.id)&&(W.splice(t,1),W.push(e),n=!0,!0)),!1===n&&W.push(e)}function le(e){W.some((n,o)=>!(!n||"object"!=typeof n||n.id!==e.id)&&(W[o].attribute=e.attribute,!0))}function ae(e){null!==e.videoprofile&&void 0!==e.videoprofile&&e.videoprofile,null!==e.screensharevideoprofile&&void 0!==e.screensharevideoprofile&&e.screensharevideoprofile,null!==e.aspublisher&&void 0!==e.aspublisher&&(w=e.aspublisher),null!==e.aslistener&&void 0!==e.aslistener&&e.aslistener,null!==e.usingdatachannel&&void 0!==e.usingdatachannel&&e.usingdatachannel,null!==e.usingvideo&&void 0!==e.usingvideo&&e.usingvideo,null!==e.usingaudio&&void 0!==e.usingaudio&&e.usingaudio,null!==e.receivingvideo&&void 0!==e.receivingvideo&&e.receivingvideo,null!==e.receivingaudio&&void 0!==e.receivingaudio&&e.receivingaudio,null!==e.bitrate&&void 0!==e.bitrate&&(T=e.bitrate),null!==e.screenbitrate&&void 0!==e.screenbitrate&&(R=e.screenbitrate),null!==e.showvideobps&&void 0!==e.showvideobps&&e.showvideobps,null!==e.sharescreen&&void 0!==e.sharescreen&&(_=e.sharescreen),null!==e.autoplaymuted&&void 0!==e.autoplaymuted&&e.autoplaymuted,null!==e.autosubscribe&&void 0!==e.autosubscribe&&e.autosubscribe,null!==e.autopublish&&void 0!==e.autopublish&&e.autopublish,null!==e.rtmpserver&&void 0!==e.rtmpserver&&(C=e.rtmpserver),null!==e.rtmpmix&&void 0!==e.rtmpmix&&(S=e.rtmpmix),null!==e.rtmpmixtemplate&&void 0!==e.rtmpmixtemplate&&(B=e.rtmpmixtemplate),null!==e.recording&&void 0!==e.recording&&(D=e.recording),null!==e.mediaserverip&&void 0!==e.mediaserverip&&(k=e.mediaserverip),null!==e.mirrorlocalvideo&&void 0!==e.mirrorlocalvideo&&e.mirrorlocalvideo,null!==e.reportmonitordata&&void 0!==e.reportmonitordata&&($=e.reportmonitordata),null!==e.reportenv&&void 0!==e.reportenv&&(ee=e.reportenv),null!==e.debuglevel&&void 0!==e.debuglevel&&(A=e.debuglevel)}function ce(e){var n=e.publishers;for(var o in i.debug("Got a list of available publishers/feeds:"),i.debug(n),n){var t=n[o].id,r=n[o].display,s=n[o].attribute,u=n[o].rtmp_pull_url;if(void 0===s&&(s=""),""!==s)le({id:t,attribute:s});void 0===u&&(u=""),i.debug(">> ["+t+"] "+r+" attr: "+s+" rtmp: "+u),void 0!==r&&r.includes("web_listener")||V(t,r,s,u)}}function de(e,n){var o=null;if(c.forEach(e=>{e&&"object"==typeof e&&e.rfid===n&&(o=e)}),!o){var t;t={id:n,videoview:e,ts:Date.now()},K.some((e,n)=>!(!e||"object"!=typeof e||e.id!==t.id||(K.splice(n,1),0))),K.push(t);for(var i=500;i<1e3;i++)if(void 0===c[i]||null===c[i]){i,c[i]=8888;break}}}function fe(e){return new Promise((n,o)=>{!function(e){K.some((n,o)=>!(!n||"object"!=typeof n||n.id!==e||(K.splice(o,1),0)))}(e);var t=!1;if(c.some((n,o)=>!(!n||"object"!=typeof n||n.rfindex!==e&&n.rfid!==e)&&(c[o]=null,n.detach(),t=!0,!0)),t){var i={};i.resolve=n,i.feedid=e,d.push(i)}else n("waring: not subscribed feedid: "+e)})}function ve(e){var n=null;K.some((o,t)=>!(!o||"object"!=typeof o||o.id!==e)&&(!(o.ts+1e4>Date.now())&&(n=o.videoview,!0))),null!=o&&o.sendlog({log:{event:"calling resubscribeStreaming",code:4,feedid:e,videoview:n,id:parseInt(g,10),ts:(new Date).toLocaleString()}}),null!==n&&(fe(e),setTimeout(()=>{de(n,e)},500))}function pe(e){if(!$)return;let n={env:ee,timestamp:e.timestamp?e.timestamp:(new Date).getTime(),appId:f,roomId:b,userId:g,message:e};r(Z.serverUrl,n)}function ge(e,n){e.success="function"==typeof e.success?e.success:i.noop,e.error="function"==typeof e.error?e.error:i.noop;let o=[];navigator.mediaDevices.enumerateDevices().then(function(t){t.forEach(function(e){e.kind===n?o.push(e):"all"===n&&o.push(e)}),e.success(o)}).catch(function(n){e.error(n)})}this.BRTC_GetStatsData=function(){return se},this.BRTC_ReplaceVideo=function(e){},this.BRTC_StopAudio=function(){},this.BRTC_ReplaceAudio=function(e){},this.BRTC_SetAudioOutputDevice=function(e){},this.BRTC_ReplaceStream=function(e){console.log("newStream: "+e)},this.BRTC_GetVideoDevices=function(e){ge(e,"videoinput")},this.BRTC_GetAudioInputDevices=function(e){ge(e,"audioinput")},this.BRTC_GetAudioOutputDevices=function(e){ge(e,"audiooutput")},this.BRTC_GetAllDevices=function(e){ge(e,"all")},this.BRTC_SetDevicesChangeListener=function(e){e="function"==typeof e?e:function(){}},this.BRTC_GetUserList=function(e){!function(e){null!=e&&(e.success="function"==typeof e.success?e.success:i.noop,e.error="function"==typeof e.error?e.error:i.noop);var n={request:"listparticipants",room:b};s.send({message:n,success:null!=e?e.success:i.noop,error:null!=e?e.error:i.noop})}(e)},this.BRTC_SubscribeStreaming=function(e,n){de(e,n)},this.BRTC_ResubscribeStreaming=function(e){ve(e)},this.BRTC_StopSubscribeStreaming=function(e){return fe(e)},this.BRTC_StartPublish=function(){},this.BRTC_StopPublish=function(){return new Promise((e,n)=>{Y=function(){e()},F=!0,s.send({message:{request:"unpublish"}})})},this.BRTC_MuteMicphone=function(e){},this.BRTC_MuteCamera=function(e){},this.BRTC_MuteCamera_legcy=function(e){},this.BRTC_MuteRemoteVideo=function(e,n,o){},this.BRTC_MuteRemoteAudio=function(e,n){},this.BRTC_SwitchScreen=function(){},this.BRTC_GetRemoteAudioLevels=function(){return[]},this.BRTC_GetRemoteUsers=function(){return W},this.BRTC_SendMessageToUser=function(e,n){if(null!==o){void 0===n&&(n=0);var t={request:"senddata",room:b,id:parseInt(g,10),to:n,data:e,internal:!1};o.send({message:t,success:function(e){}})}},this.BRTC_SetUserAttribute=function(e){if(null!==o){var n={request:"setuserattribute",room:b,id:parseInt(g,10),userattribute:e};o.send({message:n,success:function(n){var t={request:"senddata",room:b,id:parseInt(g,10),to:0,data:e,internal:!0};o.send({message:t,success:function(e){}})}})}},this.BRTC_GetUserAttribute=function(e){return new Promise((n,t)=>{if(null!==o){(e=e||{}).onattribute="function"==typeof e.onattribute?e.onattribute:function(){},void 0===e.feedid&&(e.feedid=parseInt(g,10));var i={request:"getuserattribute",room:b,id:e.feedid};o.send({message:i,success:function(o){var t={id:o.id,attribute:o.userattribute};e.onattribute(t),n(t)}})}else t()})},this.BRTC_GetRemoteVideoInfo=function(e){return{}},this.BRTC_KickoutUser=function(e){if(null!==o&&void 0!==e){var n={request:"kickoutuser",room:b,target:e};o.send({message:n,success:function(e){}})}},this.BRTC_DisbandRoom=function(){if(null!==o){var e={request:"disbandroom",room:b};o.send({message:e,success:function(e){}})}},this.BRTC_ShutUpUser=function(e,n){if(null!==o){"boolean"!=typeof n&&(n=!0);var t={request:"forwardconfigure",room:b,target:e,audio:!n,video:!n,data:!n};o.send({message:t,success:function(e){}})}},this.BRTC_SetParamSettings=function(e){ae(e=e||{})},this.BRTC_AquireDevicePermission=function(e){e.success="function"==typeof e.success?e.success:function(){},e.error="function"==typeof e.error?e.error:function(){}},this.BRTC_DeviceTest_Start=function(e){e.success="function"==typeof e.success?e.success:function(){},e.error="function"==typeof e.error?e.error:function(){},Q.usingvideo=!0,Q.usingaudio=!0,Q.mirrorlocalvideo=!0,Q.remoteaudioid="",Q.videoprofile="hires",Q.videoDeviceId=null,Q.audioDeviceId=null,Q.audioOutputDeviceId=null,Q.myStream=null,Q.onlocalstream=function(){},null!==e.usingvideo&&void 0!==e.usingvideo&&(Q.usingvideo=e.usingvideo),null!==e.usingaudio&&void 0!==e.usingaudio&&(Q.usingaudio=e.usingaudio),null!==e.videodeviceid&&void 0!==e.videodeviceid&&(Q.videoDeviceId=e.videodeviceid),null!==e.audiodeviceid&&void 0!==e.audiodeviceid&&(Q.audioDeviceId=e.audiodeviceid),null!==e.audiooutputdeviceid&&void 0!==e.audiooutputdeviceid&&(Q.audioOutputDeviceId=e.audiooutputdeviceid),null!==e.mirrorlocalvideo&&void 0!==e.mirrorlocalvideo&&(Q.mirrorlocalvideo=e.mirrorlocalvideo),null!==e.remoteaudioid&&void 0!==e.remoteaudioid&&(Q.remoteaudioid=e.remoteaudioid),null!==e.videoprofile&&void 0!==e.videoprofile&&(Q.videoprofile=e.videoprofile),Q.onlocalstream="function"==typeof e.onlocalstream?e.onlocalstream:function(){},Q.usingvideo,Q.usingaudio},this.BRTC_DeviceTest_Stop=function(){},this.BRTC_DeviceTest_MuteCamera=function(e){Q.usingaudio},this.BRTC_DeviceTest_MuteMicphone=function(e){Q.usingvideo},this.BRTC_DeviceTest_SetAudioOutputDevice=function(e){},this.BRTC_DeviceTest_ReplaceAudio=function(e){"default"!==e&&""!==e&&void 0!==e||(e=null),Q.audioDeviceId!==e&&(Q.audioDeviceId=e,console.log("BRTC_DeviceTest_ReplaceAudio audioDeviceId: "+Q.audioDeviceId),null!==Q.myStream&&Q.usingvideo)},this.BRTC_DeviceTest_ReplaceVideo=function(e){"default"!==e&&""!==e&&void 0!==e||(e=null),Q.videoDeviceId!==e&&(Q.videoDeviceId=e,console.log("BRTC_DeviceTest_ReplaceVideo videoDeviceId: "+Q.videoDeviceId),null!==Q.myStream&&Q.usingaudio)},this.BRTC_SetDebugLevel=function(e){A=e},this.BRTC_Version=function(){return t}}var c=new a;c.setThisDomID("");function d(e,n){e.success="function"==typeof e.success?e.success:function(){},e.error="function"==typeof e.error?e.error:function(){};let o=[];navigator.mediaDevices.enumerateDevices().then(function(t){t.forEach(function(e){e.kind===n?o.push(e):"all"===n&&o.push(e)}),e.success(o)}).catch(function(n){e.error(n)})}"undefined"==typeof window&&(window={}),window.BRTC_Start=function(e){null===c&&(c=new a),c.BRTC_Start(e)},window.BRTC_Stop=function(){null!=c&&c.BRTC_Stop()},window.BRTC_SendData=function(e,n){null!=c&&c.BRTC_SendData(e,n)},window.BRTC_StopVideo=function(){null!=c&&c.BRTC_StopVideo()},window.BRTC_GetStatsData=function(){if(null!=c)return c.BRTC_GetStatsData()},window.BRTC_ReplaceVideo=function(e){null!=c&&c.BRTC_ReplaceVideo(e)},window.BRTC_StopAudio=function(){null!=c&&c.BRTC_StopAudio()},window.BRTC_ReplaceAudio=function(e){null!=c&&c.BRTC_ReplaceAudio(e)},window.BRTC_SetAudioOutputDevice=function(e){null!=c&&c.BRTC_ReplaceAudio(e)},window.BRTC_ReplaceStream=function(e){null!=c&&c.BRTC_ReplaceStream(e)},window.BRTC_GetVideoDevices=function(e){d(e,"videoinput")},window.BRTC_GetAudioInputDevices=function(e){d(e,"audioinput")},window.BRTC_GetAudioOutputDevices=function(e){d(e,"audiooutput")},window.BRTC_GetAllDevices=function(e){d(e,"all")},window.BRTC_SetDevicesChangeListener=function(e){e="function"==typeof e?e:function(){},navigator.mediaDevices.ondevicechange=function(n){e(n)}},window.BRTC_GetUserList=function(e){null!=c&&c.BRTC_GetUserList(e)},window.BRTC_SubscribeStreaming=function(e,n){null!=c&&c.BRTC_SubscribeStreaming(e,n)},window.BRTC_ResubscribeStreaming=function(e){null!=c&&c.BRTC_ResubscribeStreaming(e)},window.BRTC_StopSubscribeStreaming=function(e){if(null!=c)return c.BRTC_StopSubscribeStreaming(e)},window.BRTC_StartPublish=function(){null!=c&&c.BRTC_StartPublish()},window.BRTC_StopPublish=function(){if(null!=c)return c.BRTC_StopPublish()},window.BRTC_MuteMicphone=function(e){null!=c&&c.BRTC_MuteMicphone(e)},window.BRTC_MuteCamera=function(e){null!=c&&c.BRTC_MuteCamera(e)},window.BRTC_MuteCamera_legcy=function(e){null!=c&&c.BRTC_MuteCamera_legcy(e)},window.BRTC_MuteRemoteVideo=function(e,n,o){null!=c&&c.BRTC_MuteRemoteVideo(e,n,o)},window.BRTC_MuteRemoteAudio=function(e,n){null!=c&&c.BRTC_MuteRemoteAudio(e,n)},window.BRTC_SwitchScreen=function(){null!=c&&c.BRTC_SwitchScreen()},window.BRTC_GetRemoteAudioLevels=function(){if(null!=c)return c.BRTC_GetRemoteAudioLevels()},window.BRTC_GetRemoteUsers=function(){if(null!=c)return c.BRTC_GetRemoteUsers()},window.BRTC_SendMessageToUser=function(e,n){null!=c&&c.BRTC_SendMessageToUser(e,n)},window.BRTC_SetUserAttribute=function(e){null!=c&&c.BRTC_SetUserAttribute(e)},window.BRTC_GetUserAttribute=function(e){if(null!=c)return c.BRTC_GetUserAttribute(e)},window.BRTC_GetRemoteVideoInfo=function(e){if(null!=c)return c.BRTC_GetRemoteVideoInfo(e)},window.BRTC_KickoutUser=function(e){null!=c&&c.BRTC_KickoutUser(e)},window.BRTC_DisbandRoom=function(){null!=c&&c.BRTC_DisbandRoom()},window.BRTC_ShutUpUser=function(e,n){null!=c&&c.BRTC_ShutUpUser(e,n)},window.BRTC_SetParamSettings=function(e){null!=c&&c.BRTC_SetParamSettings(e)},window.BRTC_SetDebugLevel=function(e){null!=c&&c.BRTC_SetDebugLevel(e)},window.BRTC_AquireDevicePermission=function(e){e.success="function"==typeof e.success?e.success:function(){},e.error="function"==typeof e.error?e.error:function(){},navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then(function(n){e.success(),n.getAudioTracks().forEach(function(e){e.stop()}),n.getVideoTracks().forEach(function(e){e.stop()})}).catch(function(n){e.error(n)})},window.BRTC_DeviceTest_Start=function(e){null!=c&&c.BRTC_DeviceTest_Start(e)},window.BRTC_DeviceTest_Stop=function(){null!=c&&c.BRTC_DeviceTest_Stop()},window.BRTC_DeviceTest_MuteCamera=function(e){null!=c&&c.BRTC_DeviceTest_MuteCamera(e)},window.BRTC_DeviceTest_MuteMicphone=function(e){null!=c&&c.BRTC_DeviceTest_MuteMicphone(e)},window.BRTC_DeviceTest_SetAudioOutputDevice=function(e){null!=c&&c.BRTC_DeviceTest_SetAudioOutputDevice(e)},window.BRTC_DeviceTest_ReplaceAudio=function(e){null!=c&&c.BRTC_DeviceTest_ReplaceAudio(e)},window.BRTC_DeviceTest_ReplaceVideo=function(e){null!=c&&c.BRTC_DeviceTest_ReplaceVideo(e)},window.BRTC_Version=function(){return t},window.baidurtc={},window.baidurtc.BaiduRtcRoomClient=a,(typeof module === 'object')?module.exports={BaiduRtcRoomClient:a,BRTC:c}:{}}]);